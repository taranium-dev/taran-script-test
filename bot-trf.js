require("dotenv").config();
const ethers = require("ethers");

let APP_IS_STOPPING = false;

const rpc = process.env.RPC;
const amountEther = process.env.AMOUNT_ETHER;
const intervalSeconds = parseInt(process.env.INTERVAL_SECONDS);
const burstAmount = parseInt(process.env.BURST_AMOUNT);
const flush = process.env.FLUSH === "true";
const senderSk = process.env.SENDER_PRIVATE_KEY;

const addresses = [
    "0xbE3D04a04fbB90219182b543623856ca9215A026",
    "0xb99c3C8345403b2b53C69d83509dB50be44B6427",
    "0x3726eBA61a35914547731b370386a18Db02457C9",
    "0x722EF8f45B07008e078d6e7b873757F21e796616",
    "0x2A2aA58ED10819007270B3587665373B2D7E9235",
    "0xb17B4699A7492Dbc5a373633e1D36aC1df4f157B",
    "0x9f5111A06020511C5d4cC0f03f093584ca1A7daD",
    "0x8B351BA2bE85b7468DeBCb6ff3B8678eCEf12DF9",
    "0x71c4A4921Bf3a95ddbD269b49697184c05f27B11",
    "0x25374cEA15c3CDe7e699f35b467aEedc17042c41",
    "0x820594E803F9e9536B58dD8BE1FB9161a5254EB9",
    "0x8976fE1D7567F3D3cec49b62aBA8220EFE2A4826",
    "0x487040Ad9024eBC1562FB87710fF29f69D17D829",
    "0x6362cF9CD54aa729D7299092CD6C73B7D0A8c907",
    "0xB79abD9fefE98BBbe109638b0457015Ea3d4a4D5",
    "0x0dFa7256c3720460e72568a03bf44E9F5459E121",
    "0x32DCf3a9322d2429F53ad5D11BA749d6D63A0f70",
    "0x883641285aE361d177Aa04319CE93edCcc5f94B8",
    "0xb709D7BC2AE4e7A4d7563C77EDaf899386c60711",
    "0xd456b33707B1BC77A1bfb2582784c20FA02Cc9c3",
    "0xF6aB6F5E846089Ea0e33cc67E0f43C8c909D2f93",
    "0x6b6C4f61884184bA64eb9211A1D7c7d98B0cD24a",
    "0xB52a39c9CA5c3D5187E7FddF3b292d1a4f723c97",
    "0x60c6cA55340834BaB8e412ae47061275047d7B28",
    "0x86e7f77236a51bf00560B2E4b2E1ca099FE69Fac",
    "0x889b3E1e856F55b28C3d66B8f347cC3C8b8F80CC",
    "0x5Ff4320B35AA39b9278c68531f4023a4a636Be09",
    "0xd2Da8a3D235921231DB9E3ca19d822BC6d48fd53",
    "0xa2738a501D6bd0Dd5E54FE79a1B5456c529CbB47",
    "0xeE9CF5419DB22070d85c990bA82F0A3D7E8Bd7ac",
    "0x3E56cD833c7Ef78BF518Fe823578ABF42CE45503",
    "0xB944B1A9590332106D2019fF53eeC07216B1e66e",
    "0xC15200D242592A38049DC9F8eFC90C8Ccc14c306",
    "0x7c01B4E32E803417A6BA093B8e7c32588DAA0E5E",
    "0x7eaFB46304a6d05A830950713246a8C9f573f761",
    "0xD6B3015271E6F155eAc368f3d7B2B8F69E071464",
    "0x46D19Ec48D20708C50BCd7550ba216a748d1386F",
    "0x4bb850D860097563D40239f87F8A25dEf47D2acd",
    "0x106FbD3a6Aa9fe5BcFfcb17Bb0C8B5a0dbCAef85",
    "0xdaAD4431e003df1E068D23Ed92da955a786771A6",
    "0xF5BE69071D9159AD1B42A500bb2ECb8c9517D44D",
    "0x8AcEE257ebf385Fda0C5fF18E9b1Ee7Fd0b130CB",
    "0x9D67fbD711db100b556fdbDCA4c0F10eb0BE916d",
    "0xEADFDccae0b020081573280b976fFCcC3C667cA0",
    "0xEd89FFBaBC6E0FD85daF982cFDa0B6938d6b3c0C",
    "0xa75922C96259A51b8c10a7C7f1529D85837F8D8F",
    "0xf0CB02d15FE05FA64Ec90649cA688c29Fa6A315A",
    "0x29067FF1065B238bdf2C868aa31bcbE8c0fA8675",
    "0x357D1cD1a55a5c71fAD0B286fa82c92Dd4dC3d57",
    "0xCb72d2dC391Dfb82e0c8D34091B4AabAAEa6A396",
    "0x07c6aE90356f28979De24b7376F89904429cFF9A",
    "0x970e2c2AC3484a318dC642A19EBF70C8e69D0586",
    "0x8a1144AdF6A5bDE816EffbAed556ed08fc92fedE",
    "0x35BE7bdC8c3c46E597A7696c59153b93D2a2cEC4",
    "0xbcAAa04eE8689f278cFE3739254dBa3d02dcdF90",
    "0x4F59e8104c15EABB39bb42cf085944eB620eBe09",
    "0x74432aF218B96beCA3d6aC2269138F733BeB0A2F",
    "0x39AD93709E811ab44b1415b555Fb32728aB1a8cD",
    "0x610767636224aE82Ef1dE1CF95A54B5CC6C276ad",
    "0xFc7B7D5C2DCF58585992E62D7c1c1d0aA56B055d",
    "0x597C57703a0dfac7Bb580264F204804d139bE6F1",
    "0x32d8a902EfeDA6082C6A9069a843E3efB047F2C1",
    "0x5823C10500b9beE32C4f0F2Db2F8b50DE723D664",
    "0xf555704FE6522Da68030B40f449D23508401AE85",
    "0xAd327Bc721bB78E370815F5AC6F5D9eF7D8A1F3f",
    "0x496b709F3A32Cc805A3786591356381fF5854BE3",
    "0x8F74C2CD7e95c81a295c96C6964309981184dB1C",
    "0xC8fF89e8295869a4a257882F954a1A8706652DEb",
    "0x1dB849814EEC4884D9ccCeda7D0C6D38BC018EE2",
    "0x46EFe10AF7dF4a47ccCBabdcba801a276D66B5C3",
    "0x75E414dFc1B7201d64d70CC01Fa04a155332E3A7",
    "0xb2cE1469Dcf407ae5546444A87f85FD1525788E8",
    "0x5d574C35a29C6445c932320E87f0575F9d1CC788",
    "0xD4938f53168883f28BAa368A6d6a7fda804871B3",
    "0x4A9e44B732380c60aa43861817F848C4bB05711d",
    "0xe2AfdC0FA8520AC71e71A994e28F5300913E6349",
    "0x632a10CC1F1e46622F2a6afd1Bd0a73A2a7452ef",
    "0xAd1d7524E0d0EA8b3C5152A4DdeAE57ca7332f33",
    "0xC9E280a325652c7c1e109085c387e8B83C7d367A",
    "0x193134462f33752C2F2F3F5A13aBaD9DBc380Dd9",
    "0x608Ee1bbB279afE35555DFC8CcFf6A200EEb5C02",
    "0xF3bdb1530cd3c38655a21994E048313e50e1110b",
    "0xD1cdEdb89c1A69e06E61239cCd32054788289488",
    "0x1c0611dD9223C24A649B046901c5A82a6F97779a",
    "0x82d64E395c28f13287B3Af524c14e69AF18eEB22",
    "0xa4f273CB849D3b50899272A6F6F57a17bD034562",
    "0x461F7BAE3EEd6AED3366C1DDA0f5C6EC66D89299",
    "0xE1DcDb3C5ac7f690b577670304b6280012476B58",
    "0xEA73b22AB520b905B4B72D225d949824D619f9A2",
    "0xEaC1369d1eBB0b1900f3A9d6009dbe6add28Af2c",
    "0xeA5D779204fD2fC43eA510013DC6324779b5224d",
    "0xAc4cA7d1aCe9b3fb98afF357051C2F8b3a414dC4",
    "0x0Bc33D37497c31D8f5153485C0f0C1A8f0E39349",
    "0x9d581d7C11109de9407c0214732e3c9F97CeF757",
    "0x06b607182ca490DB731AC93A005964aE5dBEDf0d",
    "0xb56530be1abe3964699b47Ccf3aD23EFDEBccC48",
    "0xf61e749E4AA475d47a8EaAa4Daca71316e86101f",
    "0xfC835DBE40a68565E2B9e96E3fC77e3ceb88e018",
    "0xc933392a566e0FCD7233f96205E3DAf4c4aFb37E",
    "0xe9590c4235e2Ca6A22da0a0a2101EeC16A1772Fd",
    "0xe974F3a09Fb68E533Bc02A7dEafCDD938e1bC70F",
    "0x5CB6a9bE3e6535f01D78A3D5b547030490c6bb3E",
    "0x8a2e560812d1edDce6e6B2A8b1De9f5305E7da8E",
    "0x64A26188ED5A555eaD6437F7917A0A8dB2F63f55",
    "0x164df193260E8f9769D263d2d9f5Fb57714dce12",
    "0xe775d1Ef31C07403b41AF4e9F8F89eb136e9c7f9",
    "0xDc4795dDEa8C03362C4ea27B959BDa4173F27F16",
    "0xc91a1A6Ff81CCE2f378e00818440Ae8D3cf13ce6",
    "0x664313ddcAa7150Ab8319A6d9FF41bb4F48C89De",
    "0x7Fff44A2F78dfA2Af2e5b7Bf06DDDcd9caDD70ca",
    "0x3a7f9Cf56850c51b4DA24cF7253e81a2010E1907",
    "0xb2f0136B5AF42d674FDC30C9c31690e3449afb06",
    "0x23E37342115c552aB987a98FC395D6cCB3F357f8",
    "0xB3AeE3B549070031360f9cFff104f8AA4b05d65B",
    "0xd4EdAf5E91Bef7F39b40F3379919Db110513dc43",
    "0x1B10DC5F645dD1a5CCf97fD15674fc834f4409a6",
    "0x356B8A5AE22140E4145df150549D897F722D127B",
    "0x57bd5B6AC7efFA054D5A9D4E6615CC94e2972BBD",
    "0x63f9288e291448ffCAB460044B600dADd7107355",
    "0xc69696f82718b69A461d965608402413C4b0B09F",
    "0xa157f1f316632Cb697ebB8865399192B251d00ed",
    "0x14BA77D7EfEd43d2144497236b34Bc0CedE3f6b6",
    "0x930F2C698be7fa333C9947ECa7dd0FCb09AFEcEA",
    "0xf25E4262bB8417F695f3C46c9723F7A0d8526e1F",
    "0xd4e93E8302F65Bc7fEC30FC7Bd5740543bBAbFB0",
    "0x8E6544792F3Cdb317949bD0f3bb51EE91f481D0E",
    "0x3dC0B2DCff2D02164e1253Cd631334AC3c4f1CCd",
    "0x2BC9BbEbaE4b54bde06BD0E57A5aC63F5e2176EF",
    "0xD7035815dc8B0305978C116175709fA28c7C0169",
    "0xE3024Af13C54e8433A59eFbDf7C120bbABa9EA4f",
    "0x1a71ba958C09bb839D1b0B55346492c406129068",
    "0x0B0410F32f785628E5491117AfF87806CD0F1507",
    "0xC8df112940e676C0c99272d32A9622d24a5F703C",
    "0x4C4cE71ad6b2642f51e04132a0B67B4Fb79A7a9d",
    "0xE41a0014fbE38E5d6EFdb784EBe734f88C8efe86",
    "0x57451912b91e2864eC81Fea79E31a53a1a6e8947",
    "0x5A6C58149A8F6C769b1B4F4E29416354e64F82C9",
    "0x63341B16bFaBB845F51833A67eDb3b26dE5BA8a8",
    "0xaad44152533cbe75857D2B12a7E1524D6cE03E8f",
    "0x4b2dB2f36556974E37613d91E0e19d06E21A5da3",
    "0x4EE5a2BA787C6F6fb0681f300A1f12Dd6E38D0df",
    "0x0ED2ef1cF5b28a11d6CA8A4Ab3553c17c9d39f7A",
    "0xD223f1A1f008a45846162D7586a03d9e4A8d9722",
    "0x54759CB94D11A3E1d424CF413ee72886f2CCaCa4",
    "0x6E274c414Cc2bbA5c9d13e050a4fA8d8b2aB419c",
    "0x5c96E11D5b5f633Dd1193323d25fF633bfe39751",
    "0xd6201b16670E481E19Fc97AC9c4B19F9ef05fcEa",
    "0x1Ca727723211A11D5Db3ecca46283937FBD02B12",
    "0x3879B16BB84f8894708952A4b26285EC68C7DDd2",
    "0xe73Bf870C413b7f1a3bB08A6c34FBDD37DE18365",
    "0x618ef1D3d89Fe46C4703644111e9e006E771F7eC",
    "0xa1c9d6f5cD401Dd7BAB8C2e46DF6C20EdD6dc270",
    "0x12f32C9C08C8951942B1FC987aEDA4EEacFD19FC",
    "0x270Cda5dd6bB83Ef4AF85eA6431ac0375CcA63D1",
    "0x7F7BF346490F689A1C29667390E2aC7d45815773",
    "0x01b7B4A72682c1b104da2f70157a8bc6C56161e7",
    "0x95e93d33f38b67565e1356A9411171fC4CA7f95d",
    "0x207A1392e9f46644c2eD57Bf76B46Ac928E79B53",
    "0xa4c0A35f1A85D0A30b5a0C42D622B71C380A431c",
    "0x5aD59CbE74E04b34CDdBd22aCec6BF21506ddbed",
    "0xE20B6f0Ed99e1660D179758861E2A6A56AA2B275",
    "0x6E1e3Dc8fc98C2F8B8c7dE936bDbe29e793a2E68",
    "0x8e989C6210d03E3374939A032705c0400Ecf7927",
    "0x9d23e66817a69bE5179963FfABb727b6fA7d904B",
    "0x1bAD2371D4d7FdfA9680b392BFb2D63e35B974fd",
    "0xb112A8e20cE4C716D03A8877F30892C330968709",
    "0x9f9815e3e8Db13B9f74289b32f3421E20104bE84",
    "0x338d16966A9823d88b135372AC3Cc38C7e2C3e5e",
    "0xD953Fdc33598956021013ecC482fdad0a5cd6648",
    "0x4EdF3271aeA5cfBc15eC360EE2Fb7c5eA0A2B1Dc",
    "0xDC35F6F6FCbC82b3f4b20713e9cE3E7B2F12bF23",
    "0x3DF07E1D44fDA784407e55754ba016e36Ea24788",
    "0x5A4D94c0188D9B0A2634A8CC494B5104e2AFbcF2",
    "0x023E7dBBa7c74A516B9b521E01f3fde458b277Bd",
    "0x3cD3e8bb2215bE236b8b073D1ea1FEE445Ebd2A0",
    "0x8F2dAE070397D722D0b73a62acCF0acA370461e1",
    "0x15E07E836231682a826fD848Dd6393089A8E129E",
    "0xd1B5605c397Ebeee79Bf5C7B867CF8b31fbcdeab",
    "0x5d05EdA71c5dFcA535236baccbD3F454102657E3",
    "0x50b2808374dEFeEddb3Af56A7E829Bd964028C4e",
    "0xc3CEf792edDB096D09B9549E82590f0feF696D04",
    "0xC67a2144B42457d43bd719e97ecC0EaA9B617879",
    "0x4337Dfd7Cc36f05F6a35aca7bea1fD0b475EEa66",
    "0x53C5bc3A405BFCF17dD628402EB5a1eb6632196b",
    "0x4097cD37E9cF8d99650BEbf1b8Ee47934C914688",
    "0x4ABD2cE30a9758f33D8924cD3628fd690952aF8e",
    "0x5d8Cdf01699323ED275d195A910d435D80Ee746E",
    "0x43344aB315C087DA71a509E318cfe0959a234651",
    "0x2190AEBce03559AC410C5749695a1c1965Be7cf5",
    "0x7A4aAa596E12232871FAfeC0FE1779EC2deA4276",
    "0xe4e1D9f77c53295B0cbEb83408ebf45A9C604CE0",
    "0xc8CccAF33772E75e0AAAeE45eB86d12A24315BD2",
    "0xc8B0Cb8D5910583901436fB93A06636c0D87873B",
    "0xb70bd06692BC14c8fac94c42762f5F869015a6F4",
    "0xB31d175787DF6C11C92f967e23243aF54391D0F7",
    "0x12bEeBD33660714f98A6634E543eA4528FC172D6",
    "0xa6A9716f277AfeEFbb5439209D694850b6C3Eb3E",
    "0x3E8155401EF2e38d99fF4037C03382A42a290a8B",
    "0x77e7F75c3D7c286854dc6622b65Dc1aa2469Be1B",
    "0x3A9C0B24D5024688883C22C7E6BF8576c76f8252",
    "0x94f8F82C09353A81A832CA33Fd854B1119D78BE6",
    "0xDAC6A97e4A5fd256BB11796378055e861c677bf0",
    "0x3cbb7cDba8E591E9003926E94Dade5586Ca8b62F",
    "0xc07C34ef3DDC22154c48061915a491D03115c5c6",
    "0x76aA62ACea870b60661212B4855Cbe8d86017Fc2",
    "0x38780eF0703A530171DA7B233BC25cA2F3Be3C23",
    "0x3269aE2c9A2FD950Bb9e079954E279482EeF72FE",
    "0x66f47d215c1cb0fA5B86a5585D0A82E7698ce85A",
    "0x9918668DABC2db8C2BE5b0484C5f8Ba588B428cB",
    "0x4bE778DB2eCd6A908D13e2c0f811eBbd052951E5",
    "0xe294c02BC57019571580789F5c1D71a524441234",
    "0xa600bAbCe52EC11582d9ee33011089dCc670c71c",
    "0x6b4F503E62eF6c963e0121E155A73CD91C0E416f",
];

const provider = new ethers.JsonRpcProvider(rpc);
const wallet = new ethers.Wallet(senderSk, provider);

const sendAmount = ethers.parseUnits(amountEther, "ether");
async function transact() {
    let nonce = await wallet.getNonce();
    const balance = await provider.getBalance(wallet.address);
    do {
        const upperNonce = nonce + burstAmount;
        let i = 0;
        while (nonce < upperNonce) {
            const to = addresses[i];
            ((n) =>
                wallet
                    .sendTransaction({
                        to,
                        value: sendAmount,
                        nonce,
                    })
                    .then(
                        (tx) =>
                            !APP_IS_STOPPING &&
                            console.log(
                                `[!] Tx with nonce '${tx.nonce}' sent!`,
                            ),
                    )
                    .catch(
                        (e) =>
                            !APP_IS_STOPPING &&
                            console.error("[!] Error Nonce: " + n),
                    ))(nonce);
            i = (i + 1) % addresses.length;
            nonce++;
        }
        await new Promise((resolve) => {
            setTimeout(() => resolve(), intervalSeconds * 1000);
        });
    } while (!APP_IS_STOPPING && !flush && balance > sendAmount);
}

process.on("SIGINT", () => {
    APP_IS_STOPPING = true;
    console.log("[!] Gracefully stopping script...");
});

transact().catch(console.error);
